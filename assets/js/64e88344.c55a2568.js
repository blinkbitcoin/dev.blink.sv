"use strict";(self.webpackChunkdev_blink_sv=self.webpackChunkdev_blink_sv||[]).push([[9645],{4095:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>d,default:()=>m,frontMatter:()=>h,metadata:()=>u,toc:()=>g});var i=n(4848),a=n(8453),o=n(1276),r=n(6540);var s=n(2556);const l=function(){const{authToken:e,setAuthToken:t}=(0,o.A)(),[n,a]=(0,r.useState)("https://api.blink.sv/auth"),[l,c]=(0,r.useState)(""),[h,d]=(0,r.useState)(""),[u,p]=(0,r.useState)(null),[g,x]=(0,r.useState)(null),[m,y]=(0,r.useState)(""),[j,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)(null),[f,T]=(0,r.useState)(null),[b,S]=(0,r.useState)(""),[C,A]=(0,r.useState)(""),[E,q]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const e=(0,s.ZD)(n,l);S(e)}),[n,l]),(0,r.useEffect)((()=>{const e=(0,s.cp)(n,m,h);A(e)}),[n,m,h]),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"1) Request a 2FA code to your email"}),(0,i.jsx)("div",{style:{marginTop:"10px"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:"The REST authentication endpoint to connect to:"}),(0,i.jsxs)("select",{type:"text",value:n,onChange:e=>a(e.target.value),style:{width:"50%",marginBottom:"10px"},children:[(0,i.jsx)("option",{value:"https://api.blink.sv/auth",children:"Blink (mainnet) - https://api.blink.sv/auth"}),(0,i.jsx)("option",{value:"https://api.staging.blink.sv/auth",children:"Staging (signet) - https://api.staging.blink.sv/auth"})]}),(0,i.jsx)("div",{}),(0,i.jsx)("input",{type:"email",placeholder:"Fill in the email address used for the account",value:l,onChange:e=>c(e.target.value),style:{width:"50%",marginBottom:"10px"}})]}),(0,i.jsx)("button",{onClick:async()=>{x(null),p(null);try{const e=await(async(e,t)=>{try{const n=await fetch(`${e}/email/code`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:t})}),i=await n.json();if(!n.ok)throw new Error(`HTTP Error: ${n.status}`);return i.result}catch(n){throw console.error("There was an error making the request:",n),n}})(n,l);y(e),p(`The emailLoginId: ${e} was obtained successfully! Check your email for the code.`)}catch(e){x(e.message)}},children:"Request code"}),(0,i.jsxs)("div",{style:{marginTop:"20px"},children:[(0,i.jsx)("h4",{children:"curl command to request an email code"}),(0,i.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:b})]}),g&&(0,i.jsxs)("div",{style:{color:"red"},children:["Error: ",g]}),u&&(0,i.jsx)("div",{style:{color:"green"},children:u}),(0,i.jsx)("div",{style:{margin:"20px 0"}}),(0,i.jsxs)("div",{style:{marginTop:"40px"},children:[(0,i.jsx)("h3",{children:"2) Enter the 2FA code received by email"}),"The email login ID from the previous request:",(0,i.jsxs)("div",{children:[(0,i.jsx)("input",{type:"text",placeholder:"Email login ID",value:m,onChange:e=>y(e.target.value),style:{width:"50%",marginBottom:"10px"}}),(0,i.jsx)("div",{}),(0,i.jsx)("input",{type:"text",placeholder:"Fill in the code from the email",value:h,onChange:e=>d(e.target.value),style:{width:"50%",marginBottom:"10px"}})]}),(0,i.jsx)("button",{onClick:async()=>{if(T(null),k(null),!m||h.length<6)T("Invalid input");else{q(!0);try{const e=await(async(e,t,n)=>{try{const i=await fetch(`${e}/email/login`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({code:n,emailLoginId:t})}),a=await i.json();if(a.error){if("too many requests"===a.error)throw new Error("You've made too many requests. Please wait and try again later.");throw new Error(a.error)}if(!a.result?.authToken)throw new Error("Expected authToken not found in the response.");return a.result.authToken}catch(i){throw console.error("There was an error making the request:",i),i}})(n,m,h);t(e),k("Logged in successfully! Find your token below.")}catch(e){T(e.message)}finally{q(!1)}}},disabled:E,children:E?"Logging in...":"Log in to get your token"})]}),(0,i.jsxs)("div",{style:{marginTop:"20px"},children:[(0,i.jsx)("h4",{children:"curl command for email login"}),(0,i.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:C})]}),f&&(0,i.jsxs)("div",{style:{color:"red"},children:["Error: ",f]}),w&&(0,i.jsx)("div",{style:{color:"green"},children:w}),e&&(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{onClick:()=>{v((e=>!e))},children:"Click to show your Authentication token"}),j&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Token:"})," ",e]})]}),(0,i.jsx)("div",{style:{marginTop:"20px"}})]})};const c=function(){const{authToken:e,setAuthToken:t}=(0,o.A)(),[n,a]=(0,r.useState)("https://api.blink.sv/graphql"),[l,c]=(0,r.useState)(""),[h,d]=(0,r.useState)(""),[u,p]=(0,r.useState)(!1),[g,x]=(0,r.useState)(null),[m,y]=(0,r.useState)(null),[j,v]=(0,r.useState)("");return(0,r.useEffect)((()=>{v((0,s.Wg)(n,l,h))}),[l,h,n]),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"Log in with phone and code"}),(0,i.jsx)("div",{children:"The GraphQL endpoint to connect to:"}),(0,i.jsxs)("select",{type:"text",value:n,onChange:e=>{a(e.target.value)},style:{width:"50%",marginBottom:"10px"},children:[(0,i.jsx)("option",{value:"https://api.blink.sv/graphql",children:"Blink (mainnet) - https://api.blink.sv/graphql"}),(0,i.jsx)("option",{value:"https://api.staging.blink.sv/graphql",children:"Staging (signet) - https://api.staging.blink.sv/graphql"})]}),(0,i.jsx)("div",{}),(0,i.jsx)("input",{type:"text",placeholder:"Phone",value:l,onChange:e=>{c(e.target.value)}}),(0,i.jsx)("div",{}),(0,i.jsx)("input",{type:"text",placeholder:"Code",value:h,onChange:e=>{d(e.target.value)}}),(0,i.jsx)("div",{}),(0,i.jsx)("button",{onClick:async()=>{if(y(null),x(null),l.length<10||h.length<6)y("Invalid input");else try{const e=await(async(e,t,n)=>{try{const i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"\n            mutation login($input: UserLoginInput!) {\n              userLogin(input: $input) {\n                authToken\n              }\n            }\n          ",variables:{input:{phone:t,code:n}}})}),a=await i.text();console.log("Raw Response:",a);const o=JSON.parse(a);if(!i.ok)throw new Error(`HTTP Error: ${i.status}`);if(o.errors&&o.errors.length>0)throw new Error(o.errors[0].message);if(!o.data?.userLogin?.authToken)throw new Error("Expected authToken not found in the response.");return o.data.userLogin.authToken}catch(i){throw console.error("There was an error making the request:",i),i}})(n,l,h);t(e),x("Got the auth token!"),v((0,s.Wg)(n,l,h))}catch(e){y(e.message)}},children:"Log in"})]}),(0,i.jsxs)("div",{style:{marginTop:"20px"},children:[(0,i.jsx)("h3",{children:"curl command for phone login"}),(0,i.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:j})]}),g&&(0,i.jsx)("div",{style:{color:"green"},children:g}),m&&(0,i.jsxs)("div",{style:{color:"red"},children:["Error: ",m]}),e&&(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{onClick:()=>{p((e=>!e))},children:"Toggle Token Visibility"}),u&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Token:"})," ",e]})]})]})},h={id:"auth",title:"Authentication",slug:"/api/legacy/auth"},d=void 0,u={id:"api/legacy/auth",title:"Authentication",description:"There are multiple ways to obtain an auth token to be used with the API.",source:"@site/docs/api/legacy/auth.mdx",sourceDirName:"api/legacy",slug:"/api/legacy/auth",permalink:"/api/legacy/auth",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"auth",title:"Authentication",slug:"/api/legacy/auth"}},p={},g=[{value:"Log in with email through the REST API",id:"log-in-with-email-through-the-rest-api",level:2},{value:"Log in with phone and code",id:"log-in-with-phone-and-code",level:2},{value:"Copy the authentication token from the Blink app",id:"copy-the-authentication-token-from-the-blink-app",level:2}];function x(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"There are multiple ways to obtain an auth token to be used with the API."}),"\n",(0,i.jsx)(t.h2,{id:"log-in-with-email-through-the-rest-api",children:"Log in with email through the REST API"}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsxs)(t.p,{children:["Make sure you have ",(0,i.jsx)(t.a,{href:"start#add-an-email-address",children:"registered your email address"})," in the Blink app to use this method."]})}),"\n",(0,i.jsx)(o.O,{children:(0,i.jsx)(l,{})}),"\n",(0,i.jsx)(t.admonition,{type:"caution",children:(0,i.jsxs)(t.p,{children:["The authentication token provides access to your wallet balance, save it securely as a password.\nUse it to make authenticated requests on the next pages or set it in the header as ",(0,i.jsx)(t.code,{children:"Authorization"})," ",(0,i.jsx)(t.code,{children:"Bearer <ory_token>"}),"."]})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"log-in-with-phone-and-code",children:"Log in with phone and code"}),"\n",(0,i.jsx)(t.p,{children:"Get a 2FA code to your phone number in the Blink app or the Dashboard and use it to log in."}),"\n",(0,i.jsx)(o.O,{children:(0,i.jsx)(c,{})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"copy-the-authentication-token-from-the-blink-app",children:"Copy the authentication token from the Blink app"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"Create new account"}),", ",(0,i.jsx)(t.code,{children:"Start with trial account"})," or ",(0,i.jsx)(t.code,{children:"Log back in with Phone or Email"})]}),"\n",(0,i.jsx)(t.li,{children:"tap the menu on the top right and scroll down"}),"\n",(0,i.jsx)(t.li,{children:"select the build number on the bottom 3 times"}),"\n",(0,i.jsxs)(t.li,{children:["select ",(0,i.jsx)(t.code,{children:"Copy access token"})," to save the token to your phone clipboard"]}),"\n"]})]})}function m(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(x,{...e})}):x(e)}},1276:(e,t,n)=>{n.d(t,{A:()=>r,O:()=>s});var i=n(6540),a=n(4848);const o=(0,i.createContext)(),r=()=>(0,i.useContext)(o),s=e=>{let{children:t}=e;const[n,r]=(0,i.useState)(null),[s,l]=(0,i.useState)("https://api.blink.sv/graphql"),[c,h]=(0,i.useState)(""),[d,u]=(0,i.useState)(""),p={authToken:n,setAuthToken:r,apiEndpoint:s,setApiEndpoint:l,accountWalletId:c,setAccountWalletId:h,paymentRequest:d,setPaymentRequest:u};return(0,a.jsx)(o.Provider,{value:p,children:t})}},2556:(e,t,n)=>{n.d(t,{Wg:()=>a,ZD:()=>i,cp:()=>o,lc:()=>r});const i=(e,t)=>{const n={email:t};return`curl -X POST '${e}/email/code' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data '${JSON.stringify(n)}'`},a=(e,t,n)=>{const i={query:"mutation login($input: UserLoginInput!) { userLogin(input: $input) { authToken } }",variables:{input:{phone:t,code:n}}};return`curl '${e}' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data-binary '${JSON.stringify(i)}'`},o=(e,t,n)=>`curl -X POST '${`${e}/email/login`}' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data '${JSON.stringify({code:n,emailLoginId:t})}'`;function r(e){let{operation:t,type:n="",setCurlCommand:i,authToken:a,apiEndpoint:o,amount:r,paymentRequest:s="",walletId:l="",walletCurrency:c="",address:h}=e,d={query:t.trim(),variables:{}};const u=a?`--header 'Authorization: Bearer ${a}'`:"--header 'Authorization: Bearer <YOUR_AUTH_TOKEN_HERE>'";"invoice"===n?d.variables.input={amount:r.toString(),walletId:l}:"feeProbe"===n||"lnInvoicePaymentSend"===n?d.variables.input={paymentRequest:s,walletId:l}:"onChainTxFee"===n?d.variables={walletId:l,address:h,amount:r}:"onChainSend"===n&&(d.variables.input={walletId:l,address:h,amount:r});let p=JSON.stringify(d).replace(/\n/g,"");i("wallet"===n?`curl -sS --request POST --header 'content-type: application/json' \\\n  ${u} \\\n  --url '${o}' \\\n  --data '{"query":"query me { me { defaultAccount { wallets { id walletCurrency }}}}", "variables":{}}' \\\n| jq '.data.me.defaultAccount.wallets[] | select(.walletCurrency == "${c}") .id'`:`curl --request POST --header 'content-type: application/json' \\\n  ${u} \\\n  --url '${o}' \\\n  --data '${p}'`)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var i=n(6540);const a={},o=i.createContext(a);function r(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);